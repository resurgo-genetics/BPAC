# pyTFBS_predict

Predict TFBS from sequence information, chromatin accessible information, and ChIP-seq.

## Installation
require numpy, pyBigWig package to be installed before pyTFBS_predict installation.

python setup.py install

## Usage

### Generate feature file

generateAttributes generateAttribute.py config_file output_file  
config_file contains:  
[setting]  
bed_file=example.bed  
read_bw_file=example.read.bw  
cut_bw_file=example.cut.bw  
bam_file=example.bam  
TSSbedFile=example.TSS.bed  
chromsizeFile=example.chrom.sizes  
phastConsFile=example.phastCons.bw  
ChIPpeakFile=example.ChIP.bed  
  
bed_file is bed6 format with score representing PWM score.  
If ChIPpeakFile entry is empty, it will generate label "-1" as undecided and can be used for test  
If read_bw_file or cut_bw_file is not provided, bam_file is used instead, read counts and cut counts are then generated from   
bam file instead of bw files. Bam file needs to be indexed by running samtools index bam_file. Total number of reads in the bam  
file is stored in bam_file".reads" file. If it is not provided, it is counted from bam_file assuming the bam_file is from the  
whole genome. bam_file processing may be very slow.  
The first 3 columns of feature file are chromosome start end  
e.g.:  
generateAttributes example.cfg output_feature.tsv  
generateAttributes example_bam.cfg output_feature.tsv (bam file)  

### Construct model  
Usage: constructModel training_feature_file output_file classifier parameters_for_classifier  
Generate model from feature file using Random Forest (RF) or Support Vector Machine (SVM)  
classifier: RF (default) or SVM  
parameters_for_classifier is in the format: param1=value1,param2=value2,param3=value3 . There are no spaces.  
e.g.:  
constructModel  output_feature.tsv modelRF.pkl RF n_estimators=200  
  
### Prediction  
Usage: predictWithModel test_file model_file output_file  
test_file is in feature file format generated by generateAttributes.  
prediction output_file is bed4 format: chromosome start end probability_being_possitive  
e.g.:  
predictWithModel test_feature.tsv modelRF.pkl pred.txt  
  
### Evaluation  
Usage: evalPrediction True Prediction positive_label  
True is a column of labels, each row is for each sample  
Prediction is a column of prediction probability, with  
positive class probability 1, negative class prob. 0  
e.g.:  
evalPrediction  <(cut -f15 test_feature.tsv) <(cut -f4 pred.txt) 1  
  
